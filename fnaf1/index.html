<!DOCTYPE html>
<html lang="en" data-bs-theme="kazwire">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>FNaF</title>
  <link rel="icon" href="/favicon.ico">
  <link rel="stylesheet" href="/themes.css">
  <script src="/creds.js"></script>
</head>
<body>
<div id="loginStatus"></div>

<script>
  const el = document.getElementById("loginStatus");

  el.style.position = "absolute";
  el.style.top = "16px";
  el.style.right = "16px";
  el.style.color = "#fff";
  el.style.textDecoration = "underline";
  el.style.fontFamily = "system-ui,sans-serif";
  el.style.fontSize = "15px";
  el.style.fontWeight = "500";
  el.style.cursor = "pointer";
  el.style.zIndex = "10";

  const waitForUID = setInterval(() => {
    if (typeof UID !== "undefined") {
      clearInterval(waitForUID);

      if (UID) {
        const user = firebase.auth().currentUser;
        if (user) {
          el.textContent = user.email.split("@")[0];
          el.style.cursor = "default";
        }
      } else {
        el.textContent = "Log in";
        el.onclick = () => {
          const redirectURL = window.location.origin;
          window.location.href =
            `https://teampwr.cbu.net/login?afterLogin=${redirectURL}`;
        };
      }
    }
  }, 100);
</script>
<header>
  <img src="/logo_navbar.png" alt="Logo">
  <nav>
    <a href="/">Home</a>
    <a href="/games">Games</a>
    <a href="/feedback">Feedback</a>
  </nav>
</header>

<div class="container">
  <div class="game-box">
    <iframe id="gameframe" src="/frame/game/fnaf/1/"></iframe>
    <div class="game-title">FNaF 1</div>
    <div class="game-author">By Scott Cawthon</div>
    <!-- Buttons: close left of fullscreen -->
    <a class="close-btn" onclick="closeGame()">X</a>
    <a class="full-btn" onclick="toggleFullscreen(document.getElementById('gameframe'))"></a>
  </div>

  <div class="ads" id="adsArea">
    <!-- One big ad will fill this space -->
  </div>
</div>

<script src="/ads/ads.js"></script>
<script>
const adsArea = document.getElementById('adsArea');
let adIndex = 0;

function rotateAd() {
  if (!ads || ads.length === 0) return;
  const ad = ads[adIndex];
  adsArea.innerHTML = '';
  const slot = document.createElement('div');
  slot.className = 'ad-slot';
  const img = document.createElement('img');
  img.src = ad.img;
  if (ad.href) {
    const link = document.createElement('a');
    link.href = ad.href;
    link.appendChild(img);
    slot.appendChild(link);
  } else {
    slot.appendChild(img);
  }
  adsArea.appendChild(slot);
  adIndex = (adIndex + 1) % ads.length;
}

rotateAd();
setInterval(rotateAd, 10000);

function toggleFullscreen(elem) {
  if (!document.fullscreenElement) {
    if (elem.requestFullscreen) elem.requestFullscreen();
    else if (elem.webkitRequestFullscreen) elem.webkitRequestFullscreen();
    else if (elem.msRequestFullscreen) elem.msRequestFullscreen();
    elem.style.borderRadius = '0';
  } else {
    if (document.exitFullscreen) document.exitFullscreen();
    else if (document.webkitExitFullscreen) document.webkitExitFullscreen();
    else if (document.msExitFullscreen) document.msExitFullscreen();
    elem.style.borderRadius = '10px';
  }

  document.addEventListener('fullscreenchange', () => {
    if (!document.fullscreenElement) {
      elem.style.borderRadius = '10px';
    }
  });
}

function closeGame() {
  const iframe = document.getElementById('gameframe');
  iframe.src = '/frame/game/closed';
}
</script>

</body>
</html>
